<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.0/firebase-app.js";
  import {
    getFirestore,
    collection,
    addDoc,
    getDocs
  } from "https://www.gstatic.com/firebasejs/11.0.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAkmuzhEK9XLH_vZ5ot0Puw9MJzdYq94QU",
    authDomain: "my-shared-app-e20d2.firebaseapp.com",
    projectId: "my-shared-app-e20d2",
    storageBucket: "my-shared-app-e20d2.firebasestorage.app",
    messagingSenderId: "559910534550",
    appId: "1:559910534550:web:bfdcda931b71573b7831b7"
  };
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  (async () => {
    try {
      // 書き込みテスト
      const docRef = await addDoc(collection(db, "testCollection"), {
        createdAt: Date.now(),
        message: "hello from local"
      });
      console.log("Added doc:", docRef.id);

      // 読み取りテスト
      const snap = await getDocs(collection(db, "testCollection"));
      snap.forEach(doc => console.log(doc.id, doc.data()));
    } catch (e) {
      console.error("Firestore test error:", e);
    }
  })();
</script>
